---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const projects = await getCollection('projects');
const blogPosts = await getCollection('blog');

function slugFromId(id: string) {
  return id.replace(/\.mdx?$/, '');
}

function getProjectYear(project: (typeof projects)[number]): number {
  const year = project.data.year;
  if (!year) return 0;
  if (Array.isArray(year)) {
    return year
      .map((value) => Number(value))
      .filter((value) => !Number.isNaN(value))
      .reduce((max, value) => Math.max(max, value), 0);
  }
  const parsed = Number(year);
  return Number.isNaN(parsed) ? 0 : parsed;
}

const latestProject = projects
  .slice()
  .sort((a, b) => getProjectYear(b) - getProjectYear(a))[0];
const latestPost = blogPosts
  .slice()
  .sort(
    (a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
  )[0];
const projectCount = projects.length;
const blogCount = blogPosts.length;
---

<BaseLayout
  title="Paul Savvas"
  description="Paul Savvas — student engineer who builds practical tools across software, hardware, and 3D design."
>
  <div
    class="min-h-screen bg-white font-sans dark:bg-neutral-950 transition-colors"
  >
    <main
      class="mx-auto flex w-full max-w-6xl flex-col gap-16 bg-white px-6 py-24 dark:bg-neutral-950 sm:px-16 sm:py-32 animate-fade-in"
    >
      <section class="hero">
        <div class="container hero-grid">
          <div class="hero-copy" data-reveal>
            <p class="eyebrow">Student, Engineer, Developer and Leader</p>
            <h1>Paul Savvas</h1>
            <p class="lede">
              Hello, I am a STEM Academy student who builds practical tools to
              help the world work better. I combine engineering, design, and
              systems thinking to create solutions that are clear, durable, and
              genuinely useful. My work spans software, hardware, and 3D design,
              where I test ideas in real conditions and refine them until they
              hold up beyond the classroom. I value simplicity, structure, and
              impact—and aim to ship tools that solve real problems and improve
              over time.
            </p>
            <p class="lede">
              This website showcases my projects, designs, and contributions
              across various domains. Feel free to explore my work, and connect
              with me on GitHub, Thingiverse, or Gravatar.
            </p>
            <div class="hero-actions">
              <a
                class="button ghost"
                href="https://github.com/psavvas"
                target="_blank"
                rel="noopener noreferrer"
              >
                GitHub
              </a>
              <a
                class="button ghost"
                href="https://www.thingiverse.com/psavvas"
                target="_blank"
                rel="noopener noreferrer"
              >
                Thingiverse
              </a>
              <a
                class="button ghost"
                href="https://gravatar.com/psavvas"
                target="_blank"
                rel="noopener noreferrer"
              >
                Gravatar
              </a>
            </div>
            <div class="hero-chips">
              <span class="chip">STEM Academy · Grade 10</span>
              <span class="chip">Product + Engineering</span>
            </div>
          </div>
          <div class="hero-panel card" data-reveal>
            <div class="panel-head">
              <span class="live-pill" aria-label="Live">LIVE</span>
            </div>
            <div class="meta-row">
              <div class="meta-block meta-block--full live-signal">
                <p class="label">Latest project</p>
                {
                  latestProject ? (
                    <a
                      class="value value-link"
                      href={`/projects/${slugFromId(latestProject.id)}`}
                    >
                      <span class="value-text">{latestProject.data.title}</span>
                      <svg
                        class="value-arrow"
                        viewBox="0 0 24 24"
                        aria-hidden="true"
                        focusable="false"
                      >
                        <path
                          d="M5 12h12m0 0-4-4m4 4-4 4"
                          fill="none"
                          stroke="currentColor"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                        />
                      </svg>
                    </a>
                  ) : (
                    <p class="value">New project coming soon</p>
                  )
                }
              </div>
            </div>
            <div class="meta-row">
              <div class="meta-block meta-block--full live-signal">
                <p class="label">Latest blog post</p>
                {
                  latestPost ? (
                    <a
                      class="value value-link"
                      href={`/blog/${slugFromId(latestPost.id)}`}
                    >
                      <span class="value-text">{latestPost.data.title}</span>
                      <svg
                        class="value-arrow"
                        viewBox="0 0 24 24"
                        aria-hidden="true"
                        focusable="false"
                      >
                        <path
                          d="M5 12h12m0 0-4-4m4 4-4 4"
                          fill="none"
                          stroke="currentColor"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                        />
                      </svg>
                    </a>
                  ) : (
                    <p class="value">New post coming soon</p>
                  )
                }
              </div>
            </div>
            <div class="meta-row">
              <div class="meta-block live-signal">
                <p class="label">Projects</p>
                <a class="value value-link" href="/projects">
                  <span class="value-text">
                    {projectCount}
                    {projectCount === 1 ? 'project' : 'projects'}
                  </span>
                  <svg
                    class="value-arrow"
                    viewBox="0 0 24 24"
                    aria-hidden="true"
                    focusable="false"
                  >
                    <path
                      d="M5 12h12m0 0-4-4m4 4-4 4"
                      fill="none"
                      stroke="currentColor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"></path>
                  </svg>
                </a>
              </div>
              <div class="meta-block live-signal">
                <p class="label">Blog posts</p>
                <a class="value value-link" href="/blog">
                  <span class="value-text">
                    {blogCount}
                    {blogCount === 1 ? 'post' : 'posts'}
                  </span>
                  <svg
                    class="value-arrow"
                    viewBox="0 0 24 24"
                    aria-hidden="true"
                    focusable="false"
                  >
                    <path
                      d="M5 12h12m0 0-4-4m4 4-4 4"
                      fill="none"
                      stroke="currentColor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"></path>
                  </svg>
                </a>
              </div>
            </div>
            <div class="meta-row">
              <div class="meta-block live-signal">
                <p class="label">School</p>
                <p class="value">GMHS STEM Academy</p>
              </div>
              <div class="meta-block live-signal">
                <p class="label">Location</p>
                <p class="value">Maryland, USA</p>
              </div>
            </div>
            <div class="meta-row">
              <div class="meta-block meta-block--full live-signal">
                <p class="label">Languages</p>
                <p class="value">English, French, Spanish (Intermediate)</p>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>
</BaseLayout>
