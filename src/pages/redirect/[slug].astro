---
import { shortlinks } from '../../data/site';

export function getStaticPaths() {
  return Object.keys(shortlinks).map((key) => ({
    params: { slug: key },
  }));
}

const { slug } = Astro.params;
const destination = shortlinks[slug!];

if (!destination) {
  return Astro.redirect('/404');
}

// For internal (same-origin) paths, use Astro.redirect directly
if (destination.startsWith('/')) {
  return Astro.redirect(destination, 302);
}

// For external URLs, use Astro.redirect as well
return Astro.redirect(destination, 302);
---
