---
import BaseLayout from '../layouts/BaseLayout.astro';

interface ProjectItem {
  name: string;
  description: string;
  categories: string[];
  timeframe?: string | string[];
  highlighted?: boolean;
  externalUrl?: string;
  codeRepository?: string;
  customLink?: {
    text: string;
    url: string;
  };
  detailSlug?: string;
}

const determineGitHubUrl = (repo?: string) => {
  if (!repo) return undefined;
  const cleaned = repo.trim();
  if (!cleaned) return undefined;
  if (cleaned.startsWith('http://') || cleaned.startsWith('https://')) {
    return cleaned;
  }
  return `https://github.com/${cleaned.replace(/^\//, '')}`;
};

const getProjectLink = (proj: ProjectItem): { url: string; external: boolean } | null => {
  if (proj.detailSlug) {
    return {
      url: `/projects/${proj.detailSlug}`,
      external: false,
    };
  } else if (proj.customLink) {
    return {
      url: proj.customLink.url,
      external: true,
    };
  } else {
    const repoLink = determineGitHubUrl(proj.codeRepository);
    if (repoLink) {
      return {
        url: repoLink,
        external: true,
      };
    }
  }
  return null;
};

const formatYearRange = (timeframe?: string | string[]) => {
  if (!timeframe) return undefined;
  const yearArray = Array.isArray(timeframe) ? timeframe : [timeframe];
  const yearNumbers = yearArray
    .map((y) => Number(String(y).trim()))
    .filter((n) => !Number.isNaN(n));
  
  if (yearNumbers.length === 1) {
    return String(yearNumbers[0]);
  } else if (yearNumbers.length > 1) {
    const earliest = Math.min(...yearNumbers);
    const latest = Math.max(...yearNumbers);
    return `${earliest}–${latest}`;
  }
  return undefined;
};

const projectsList: ProjectItem[] = [
  {
    name: 'InfantGuard',
    description:
      'Infant Guard is a fully integrated, Arduino-driven safety platform engineered to detect forgotten infants in vehicles and escalate alerts before temperatures reach life-threatening levels.',
    categories: ['Arduino', 'IoT', 'Safety', 'Hardware'],
    timeframe: ['2025'],
    highlighted: true,
    detailSlug: 'infantguard',
  },
  {
    name: 'Personal Portfolio Website',
    description:
      'This website! Built with Next.js and Tailwind CSS, it showcases my projects, skills, and contact information in a clean and modern design.',
    categories: ['Next.js', 'Tailwind CSS', 'Portfolio'],
    timeframe: ['2025'],
    highlighted: false,
    codeRepository: 'psavvas/personal-portfolio-website',
  },
  {
    name: 'Daily Digest',
    description:
      'DailyDigest is a Python application that automatically generates and sends a daily summary email containing your upcoming calendar events, reminders, local weather, and a motivational quote.',
    categories: ['Productivity', 'Coding', 'Python Scripts'],
    timeframe: ['2025'],
    highlighted: true,
    codeRepository: 'psavvas/daily-digest',
  },
  {
    name: 'MoleMini',
    description:
      'Mole Mini is an all-in-one chemistry computer helping with complex calculations and conversions, created by myself and Connor Denihan in 2025.',
    categories: ['Microcomputer', 'Chemistry', 'Education'],
    timeframe: ['2025'],
    highlighted: false,
    codeRepository: 'cdenihan/mole-day-project',
  },
  {
    name: 'Notion Templates',
    description:
      'A series of high-quality Notion templates designed to enhance productivity and organization, free for personal and professional use. Ranging from team hubs to personal planners.',
    categories: ['Productivity', 'Lifestyle', 'Notion'],
    timeframe: ['2025'],
    highlighted: true,
    detailSlug: 'notion-templates',
  },
  {
    name: '3D Printing for Shock Absorption',
    description:
      'A 1st place Science Fair project investigating how different infills could affect the shock absorption properties of different objects, through research and custom infills.',
    categories: ['3D Printing', 'Science Fair', 'Research'],
    timeframe: ['2024'],
    highlighted: true,
    detailSlug: '3d-printing-shock-absorption',
  },
  {
    name: 'Aircraft Cabin Redesign',
    description:
      'A recreational project, aiming to redesign aircraft cabin and airline seating for improved comfort and functionality, through 3D modeling.',
    categories: ['3D Printing', 'CAD', 'Aviation'],
    timeframe: ['2024'],
    highlighted: false,
    detailSlug: 'aircraft-cabin-redesign',
  },
];

const githubProfileUrl = 'https://github.com/psavvas';
const thingiverseProfileUrl = 'https://www.thingiverse.com/psavvas';
---

<BaseLayout pageTitle="Projects | Paul Savvas" pageDescription="Projects by Paul Savvas — a selection of work across software, hardware, and 3D design.">
  <div class="min-h-screen bg-white font-sans dark:bg-neutral-950 transition-colors">
    <main class="mx-auto w-full max-w-6xl bg-white px-6 py-16 dark:bg-neutral-950 sm:px-16 sm:py-24 animate-fade-in">
      <header class="max-w-3xl animate-fade-in-up">
        <p class="text-sm font-medium uppercase tracking-wider text-neutral-600 dark:text-neutral-400">
          Projects
        </p>
        <h1 class="mt-3 text-4xl font-semibold tracking-tight text-neutral-900 dark:text-neutral-100 sm:text-5xl">
          Simple. Practical. Impactful.
        </h1>
          <p class="mt-6 text-base leading-7 text-neutral-700 dark:text-neutral-300">
          A growing collection of software, hardware, and 3D design work. I'm drawn to projects that can have a positive impact on the world—whether in small, everyday ways or larger initiatives—while staying grounded in real constraints and performing well in practice.
          </p>

        <div class="mt-8">
          <a
            class="inline-flex items-center justify-center rounded-md border border-neutral-200 bg-white px-4 py-2 text-sm font-medium text-neutral-900 transition-colors hover:bg-neutral-50 dark:border-neutral-800 dark:bg-neutral-950 dark:text-neutral-100 dark:hover:bg-neutral-900 hover-lift"
            href={githubProfileUrl}
            target="_blank"
            rel="noopener noreferrer"
          >
            Browse all code projects on GitHub
          </a>
          <a
            class="ml-4 inline-flex items-center justify-center rounded-md border border-neutral-200 bg-white px-4 py-2 text-sm font-medium text-neutral-900 transition-colors hover:bg-neutral-50 dark:border-neutral-800 dark:bg-neutral-950 dark:text-neutral-100 dark:hover:bg-neutral-900 hover-lift"
            href={thingiverseProfileUrl}
            target="_blank"
            rel="noopener noreferrer"
          >
            Browse all 3D design projects on Thingiverse
          </a>
        </div>
      </header>

      <section class="mt-14">
        <div class="animate-fade-in-up">
          <h2 class="text-xl font-semibold tracking-tight text-neutral-900 dark:text-neutral-100">
            Featured Projects
          </h2>
          <p class="mt-3 max-w-3xl text-sm leading-6 text-neutral-600 dark:text-neutral-400">
            A few of my most impactful, noteworthy or favorite projects.
          </p>
        </div>

        <div class="mt-8 grid gap-6 md:grid-cols-2">
          {projectsList
            .filter((p) => p.highlighted !== false)
            .map((proj) => {
            const linkInfo = getProjectLink(proj);
            const displayYear = formatYearRange(proj.timeframe);

            return (
              <article
                class="rounded-xl border border-neutral-200 bg-white p-6 dark:border-neutral-800 dark:bg-neutral-950 hover-lift animate-fade-in-up"
              >
                <div class="flex flex-wrap items-center justify-between gap-3">
                  <h3 class="text-lg font-semibold text-neutral-900 dark:text-neutral-100">
                    {proj.name}
                  </h3>
                  {displayYear && (
                    <span class="inline-flex items-center rounded-full border border-neutral-200 px-3 py-1 text-xs font-medium text-neutral-700 dark:border-neutral-800 dark:text-neutral-300">
                      {displayYear}
                    </span>
                  )}
                </div>

                <p class="mt-3 text-sm leading-6 text-neutral-700 dark:text-neutral-300">
                  {proj.description}
                </p>

                <div class="mt-4 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
                  <div class="flex flex-wrap gap-2">
                    {proj.categories.map((cat) => (
                      <span
                        class="inline-flex items-center rounded-full bg-neutral-100 px-3 py-1 text-xs font-medium text-neutral-700 dark:bg-neutral-900 dark:text-neutral-300"
                      >
                        {cat}
                      </span>
                    ))}
                  </div>

                  <div class="flex flex-wrap gap-3 sm:justify-end">
                    {linkInfo && (
                      <a
                        class="inline-flex items-center justify-center rounded-md border border-neutral-200 bg-white px-4 py-2 text-sm font-medium text-neutral-900 transition-colors hover:bg-neutral-50 dark:border-neutral-800 dark:bg-neutral-950 dark:text-neutral-100 dark:hover:bg-neutral-900 hover-lift"
                        href={linkInfo.url}
                        {...(linkInfo.external ? { target: "_blank", rel: "noopener noreferrer" } : {})}
                      >
                        Learn More
                      </a>
                    )}
                  </div>
                </div>
              </article>
            );
          })}
        </div>
      </section>

      <section class="mt-14 max-w-3xl animate-fade-in-up animation-delay-300">
        <h2 class="text-xl font-semibold tracking-tight text-neutral-900 dark:text-neutral-100">
          How I evaluate a project
        </h2>
        <ul class="mt-4 list-disc space-y-2 pl-5 text-base leading-7 text-neutral-700 dark:text-neutral-300">
          <li>
            Clarity: can someone understand the goal and approach quickly?
          </li>
          <li>
            Constraints: does it work within real limits (time, materials,
            performance)?
          </li>
          <li>Results: are outcomes measurable, testable, and repeatable?</li>
          <li>Iteration: what changed after the first version shipped?</li>
        </ul>
      </section>

      <section class="mt-14">
        <div class="animate-fade-in-up">
          <h2 class="text-xl font-semibold tracking-tight text-neutral-900 dark:text-neutral-100">
            All projects
          </h2>
          <p class="mt-3 max-w-3xl text-sm leading-6 text-neutral-600 dark:text-neutral-400">
            A complete list of projects with links and quick context.
          </p>
        </div>

        <ul class="mt-6 rounded-xl border border-neutral-200 bg-white dark:border-neutral-800 dark:bg-neutral-950 divide-y divide-neutral-200 dark:divide-neutral-800">
          {projectsList.map((proj) => {
            const linkInfo = getProjectLink(proj);
            const displayYear = formatYearRange(proj.timeframe);

            return (
              <li
                class="p-4 sm:p-5 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between animate-fade-in-up"
              >
                <div>
                  <div class="flex items-center gap-3">
                    <span class="text-sm font-medium text-neutral-900 dark:text-neutral-100">
                      {proj.name}
                    </span>
                    {displayYear && (
                      <span class="inline-flex items-center rounded-full border border-neutral-200 px-2.5 py-0.5 text-[11px] font-medium text-neutral-700 dark:border-neutral-800 dark:text-neutral-300">
                        {displayYear}
                      </span>
                    )}
                  </div>
                  <p class="mt-1 text-sm leading-6 text-neutral-700 dark:text-neutral-300 line-clamp-2">
                    {proj.description}
                  </p>
                  <div class="mt-2 flex flex-wrap gap-2">
                    {proj.categories.map((cat) => (
                      <span
                        class="inline-flex items-center rounded-full bg-neutral-100 px-2.5 py-0.5 text-[11px] font-medium text-neutral-700 dark:bg-neutral-900 dark:text-neutral-300"
                      >
                        {cat}
                      </span>
                    ))}
                  </div>
                </div>

                <div class="flex gap-3 sm:ml-6">
                  {linkInfo && (
                    <a
                      class="inline-flex items-center justify-center rounded-md border border-neutral-200 bg-white px-3 py-1.5 text-sm font-medium text-neutral-900 transition-colors hover:bg-neutral-50 dark:border-neutral-800 dark:bg-neutral-950 dark:text-neutral-100 dark:hover:bg-neutral-900 hover-lift"
                      href={linkInfo.url}
                      {...(linkInfo.external ? { target: "_blank", rel: "noopener noreferrer" } : {})}
                    >
                      View
                    </a>
                  )}
                </div>
              </li>
            );
          })}
        </ul>
      </section>
    </main>
  </div>
</BaseLayout>
